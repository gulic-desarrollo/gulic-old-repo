%%% Copyright   Miguel Ángel Vilela
%%%             Facultad de Matemáticas
%%%             Universidad de La Laguna
%%%             C/ Astrofísico Francisco Sánchez
%%%             E-mail miguev@fmat.ull.es
%%%
%%% With code from: fncychap.sty, written by Ulf A. Lindgren <lindgren@ae.chalmers.se>
%%%                 ull.sty,      written by Manolo G. Román <mroman@ull.es>
%%%
%%%
%%% Note        Premission is granted to modify this file under
%%%             the condition that it is saved using another
%%%             file and package name.
%%%
%%% Revision    0.1
%%%
%%%             Feb. 22th Started package.
%%%
%%% Last modified    February 22th 2002

\NeedsTeXFormat{LaTeX2e}[1995/12/01]
\ProvidesPackage{tila}
             [2002/02/22 v0.1
                 LaTeX package (Estilo para los apuntes del TILA)]

%%%
%%% Definiciones de los márgenes y otras longitudes
%%%
\setlength{\paperwidth}{18cm}
\setlength{\paperheight}{24cm}
\setlength{\hoffset}{0cm}
\setlength{\voffset}{-0.5cm}
\setlength{\textwidth}{13cm}
\setlength{\textheight}{18cm}
%=\setlength{\oddsidemargin}{1cm}
%=\setlength{\evensidemargin}{1cm}
%=\setlength{\topmargin}{1cm}
%=\setlength{\headheight}{1cm}
%=\setlength{\headsep}{1cm}
%=\setlength{\footskip}{1cm}
\setlength{\parindent}{0cm}
\setlength{\parskip}{1.5ex plus 0.5ex minus 0.5ex}
\setcounter{secnumdepth}{3}
\setcounter{tocdepth}{1}

%%%
%%% Comando para crear el nombre de LyX tal como lo hace el propio LyX
%%% esta línea (con \providedcommand) es incluida por LyX al exportar a LaTeX
%%%
\newcommand{\LyX}{L\kern-.1667em\lower.25em\hbox{Y}\kern-.125emX\@}

%%%
%%% Comandos para siglas
%%%
\newcommand{\FMAT}{{\sc Facultad de Matemáticas}}
\newcommand{\ULL}{{\sc Universidad de La Laguna}}
\newcommand{\GULiC}{{\sc Grupo de Usuarios de Linux de Canarias}}
\newcommand{\CILA}{Curso de Introdución a Linux para Alumnos}
\newcommand{\PILA}{Party de Instalación de Linux para Alumnos}
\newcommand{\TIL}{Taller de Iniciación a Linux}
\newcommand{\TILA}{Taller de Iniciación a Linux para Alumnos}

%%%
%%% Anula la conversión a mayúsculas
%%%
\renewcommand{\MakeUppercase}{}

%%%
%%% Estilo de pies de páginas, con fancyhdr
%%% requiere \usepackage{fancyhdr}
%%%
\pagestyle{fancy}
\fancyhead[RE]{\sf \leftmark}
\fancyhead[LO]{\sf \rightmark}
\fancyhead[LE,RO]{\sf \thepage}
\fancyfoot[LO,LE,RE,RO]{}
\fancyfoot[CE]{\rule{\headwidth}{0.5pt}\hskip \headwidth \sf\sc\TILA}
\fancyfoot[CO]{\rule{\headwidth}{0.5pt}\hskip \headwidth \sf\copyright ~2002 \GULiC}

%%%
%%% Implementación en  TeX del  "Índice de  ejemplos" Crea  el entorno
%%% "ejemplo" y el contador "nejemplo" Su uso es:
%%%
%%% En el lugar donde se desee  poner el "Índice de ejemplos" utilizar
%%% el comando \listadeejemplos
%%%
%%% Para poner  un ejemplo  en el documento:  (Los dos  argumentos son
%%% obligatorios)
%%%
%%% \begin{ejemplo}{Nombre del fichero de ejemplo}{Descripción corta del ejemplo}
%%%   Descripción y comentarios del ejemplo.
%%% \end{ejemplo}
%%%
%%% El nombre  del fichero titulará  el ejemplo en la  parte superior,
%%% con una etiqueta de "Fichero <nombrefichero>"
%%%
%%% La descripcion corta será la referencia que aparecerá en el Índice
%%% de ejemplos.
%%%
%%% La descripción (mas larga) del ejemplo aparecera recuadrada debajo
%%% del mismo.
%%%
%%% Ejemplo de uso:
%%%
%%% \begin{ejemplo}{hola.c}{HolaMundo en ANSI C}
%%%   Este codigo en ANSI C muestra un programa basico de HolaMundo,
%%%   que se limita a imprimir la cadena "Hola Mundo" en la salida estandar.
%%% \end{ejemplo}
%%%
\newcommand{\listadeejemplos}{%
\cleardoublepage\chapter*{Índice de ejemplos}% Creamos el índice de ejemplos
\label{IndiceDeEjemplos}\@starttoc{lde}}%      y lo etiquetamos 
\newcounter{nejemplo}[chapter]%                Contador subordinado al chapter
\newcommand{\ejemploname}{Ejemplo }%           Nombre de la etiqueta
\newcommand{\ejemplopath}{ejemplos/}%          Directorio de ejemplos
\newenvironment{ejemplo}[2]{%                  Entorno "ejemplo", 2 argumentos
\newcommand{\source}{#1} %                     Descripción corta del ejemplo
\newcommand{\descripcion}{{\tt[#1]} #2} %      Descripción larga del ejemplo
\vspace*{2mm}%                                 Pequeño margen superior 
\fbox{\sf Fichero \tt \source}\newline%        Nombre del fichero del ejemplo
\rule[5mm]{\textwidth}{1pt} %                  Regla separadora al principio
\stepcounter{nejemplo}%                        Se incremente el contador y
\addcontentsline{lde}{section}{%               se añade una línea al índice
\protect\numberline{\thechapter.\thenejemplo}\descripcion}%  de ejemplos
\vspace{-15mm}%                				   Se ajustan espacios
\verbatiminput{\ejemplopath\source}%          Se incluye el fichero fuente
\vspace{-6mm}%                				   Se ajustan espacios
\rule[1mm]{\textwidth}{1pt}\newline %          Se inserta un \n y otra regla
\begin{tabular}{|p{0.97\textwidth}|}%          Se abre una tabla para la
\hline%\rowcolor[gray]{0.9}%                   descripción del ejemplo, con
\sf\ejemploname\thechapter.\thenejemplo:}{\\ % color gris claro de fondo
\hline\end{tabular}\vspace{4mm}}%              Se deja un espacio vertical 

%%%
%%% Comando para incluir una página (par) vacía tras cada tema incluido.
%%% Así se  evita que salgan páginas  pares vacías con las  cabeceras al
%%% final de los temas.
%%%
\newcommand{\incluir}[1]{\include{#1}\newpage\thispagestyle{empty}}


%%% 
%%% Definición de \chapter, modificación de una opción del paquete fncychap.sty
%%%

%%%% DEFINITION OF Chapapp variables
\newcommand{\CNV}{\huge\bfseries}
\newcommand{\ChNameVar}[1]{\renewcommand{\CNV}{#1}}


%%%% DEFINITION OF TheChapter variables
\newcommand{\CNoV}{\huge\bfseries}
\newcommand{\ChNumVar}[1]{\renewcommand{\CNoV}{#1}}

\newif\ifUCN
\UCNfalse
\newif\ifLCN
\LCNfalse
\def\ChNameLowerCase{\LCNtrue\UCNfalse}
\def\ChNameUpperCase{\UCNtrue\LCNfalse}
\def\ChNameAsIs{\UCNfalse\LCNfalse}
\newcommand{\FmN}[1]{%
\ifUCN
   {\MakeUppercase#1}\LCNfalse
\else
   \ifLCN
      {\MakeLowercase#1}\UCNfalse
   \else #1
  \fi
\fi}


%%%% DEFINITION OF Title variables
\newcommand{\CTV}{\Huge\bfseries}
\newcommand{\ChTitleVar}[1]{\renewcommand{\CTV}{#1}}

%%%% DEFINITION OF the basic rule width
\newlength{\RW}
\setlength{\RW}{1pt}
\newcommand{\ChRuleWidth}[1]{\setlength{\RW}{#1}}

\newif\ifUCT
\UCTfalse
\newif\ifLCT
\LCTfalse
\def\ChTitleLowerCase{\LCTtrue\UCTfalse}
\def\ChTitleUpperCase{\UCTtrue\LCTfalse}
\def\ChTitleAsIs{\UCTfalse\LCTfalse}
\newcommand{\FmTi}[1]{%
\ifUCT
   {\MakeUppercase#1}\LCTfalse
\else
   \ifLCT
      {\MakeLowercase#1}\UCTfalse
   \else #1
   \fi
\fi}



\newlength{\mylen}
\newlength{\myhi}
\newlength{\px}
\newlength{\py}
\newlength{\pyy}
\newlength{\pxx}


\def\mghrulefill#1{\leavevmode\leaders\hrule\@height #1\hfill\kern\z@}

\newcommand{\DOCH}{%
  \CNV\FmN{\@chapapp}\space \CNoV\thechapter
  \par\nobreak
  \vskip 20\p@
  }
\newcommand{\DOTI}[1]{%
    \CTV\FmTi{#1}\par\nobreak
    \vskip 40\p@
    }
\newcommand{\DOTIS}[1]{%
    \CTV\FmTi{#1}\par\nobreak
    \vskip 40\p@
    }

\ChNameUpperCase
\ChNameVar{\centering\large\rm}
\ChNumVar{\Large}
\ChTitleVar{\centering\Huge\rm}
\ChRuleWidth{2pt}
\renewcommand{\DOCH}{%
  \settoheight{\py}{\CNoV\thechapter}
  \addtolength{\py}{-1pt}
  %\CNV\FmN{\@chapapp}\par\nobreak
  \vskip 20\p@
  \setlength{\myhi}{2.5\baselineskip}
	\setlength{\px}{\myhi}
	\addtolength{\px}{-1\RW}
	\rule[-1.003\px]{\RW}{\myhi}\mghrulefill{\RW}
	\hskip 10pt
	\raisebox{-0.5\py}{\CNV\FmN{\@chapapp} \CNoV\thechapter}
	\hskip 10pt
	\mghrulefill{\RW}\rule[-1.003\px]{\RW}{\myhi}
	\par\nobreak
	\vskip -15\p@
  }
\renewcommand{\DOTI}[1]{%
  \setlength{\mylen}{\textwidth}
  \addtolength{\mylen}{-2\RW}
  {\vrule width\RW}\parbox{\mylen}{\CTV\FmTi{#1}}{\vrule width\RW}
	\par\nobreak
	\vskip -10pt
	\rule{\RW}{2\baselineskip}\mghrulefill{\RW}\rule{\RW}{2\baselineskip}
	\vskip 60\p@
  }
\renewcommand{\DOTIS}[1]{%
  \setlength{\py}{\fboxrule}
  \setlength{\fboxrule}{\RW}
  \setlength{\mylen}{\textwidth}
  \addtolength{\mylen}{-2\RW}
	\fbox{\parbox{\mylen}{\vskip 2\baselineskip\CTV\FmTi{#1}
	\par\nobreak\vskip \baselineskip}} 
  \setlength{\fboxrule}{\py}
  \vskip 60\p@
  }

\ProcessOptions* \relax

\def\@makechapterhead#1{%
  \vspace*{50\p@}%
  {\parindent \z@ \raggedright \normalfont
    \ifnum \c@secnumdepth >\m@ne
      \DOCH
    \fi
    \interlinepenalty\@M
    \DOTI{#1}
  }}
\def\@schapter#1{\if@twocolumn
                   \@topnewpage[\@makeschapterhead{#1}]%
                 \else
                   \@makeschapterhead{#1}%
                   \@afterheading
                 \fi}
\def\@makeschapterhead#1{%
  \vspace*{50\p@}%
  {\parindent \z@ \raggedright
    \normalfont
    \interlinepenalty\@M
    \DOTIS{#1}
    \vskip 40\p@
  }}

\endinput

%%%
%%%  Definicion de \part, modificación de la definición de \part de ull.sty
%%%

\def\thepart{\Roman{part}}
\def\part{\cleardoublepage   % Empieza nueva página.
   \thispagestyle{empty}     % El estilo de la pagina Parte es 'plain'
  \if@twocolumn              % IF estilo two-column
     \onecolumn              %  THEN \onecolumn
     \@tempswatrue           %       @tempswa := true
    \else \@tempswafalse     %  ELSE @tempswa := false
  \fi                        % FI
  \secdef\@part\@spart}

%%% BEGIN: Redefinición de \@part utilizando el estilo de \chapter (de fncychap)
\def\@part[#1]#2{\ifnum \c@secnumdepth >-2\relax  % IF secnumdepth > -2
        \refstepcounter{part}                     %   THEN aumenta contador
        \addcontentsline{toc}{part}{\Large\sc #1}       % añade al indice
        \else                                     % ELSE añade linea sin numerar
        \addcontentsline{toc}{part}{\Large\sc #1}\fi    % FI
   \markboth{}{}
   {\center
   % Si secnumdepth > -2 Imprime 'Modulo <1>' en el borde superior del recuadro.
   % En otro caso sólo imprime el título dentro del recuadro
    \vspace*{40mm}
    \ifnum \c@secnumdepth >-2\relax
	   	\vskip 20\p@
		\setlength{\myhi}{2.5\baselineskip}
		\setlength{\px}{\myhi}
		\addtolength{\px}{-1\RW}
		\rule[-1.003\px]{\RW}{\myhi}\mghrulefill{\RW}
		\hskip 10pt
		\raisebox{-0.5\py}{\CNV\FmN{\partname} {\Huge\thepart}}
		\hskip 10pt
		\mghrulefill{\RW}\rule[-1.003\px]{\RW}{\myhi}
		\par\nobreak
		\vskip -15\p@
		\setlength{\mylen}{\textwidth}
		\addtolength{\mylen}{-2\RW}
		{\vrule width\RW}\parbox{\mylen}{\CTV\FmTi{#1}}{\vrule width\RW}
		\par\nobreak
		\vskip -10pt
		\rule{\RW}{2\baselineskip}\mghrulefill{\RW}\rule{\RW}{2\baselineskip}
		\vskip 60\p@
	\fi
	}\@endpart}

\def\@endpart{\vfil\newpage
   \if@twoside
       \hbox{}
       \thispagestyle{empty}
       \newpage
   \fi
   \if@tempswa
    \twocolumn
   \fi}
%%% END: Redefinición de \@part utilizando el estilo de \chapter (de fncychap)



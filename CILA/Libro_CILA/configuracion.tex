%Autor: mojopikon

%MojoPikon les ruega que no le majen por las posibles desfiguraciones que este texto sufra
%en momentos concretos debido a un "lo pongo así y luego más adelante cuando lo tenga más
%perfiladito lo pongo bien puestito".
%GRACIAS.

\chapter{Configuración}
\index{configuración}

\section{El Kernel de Linux}
Introducción:

Con la cantidad de distribuciones de Linux que hay hoy en día circulando por la red, escribir cualquier texto sobre configuración requeriría dedicar un libro entero para cubrir las distintas formas de configuración que tienen cada una de estas: el SaX y el yast2 de SuSE, los paneles de control de mandrake, y otras cosas por el estilo son cosas que no abordaremos aquí, por ser específicas, e inútiles para los usuarios que no tengan estas distribuciones.

Sin embargo, en esta sección veremos algunas técnicas que puedan servirnos para cualquier distribución de linux.

¿Como configuro mi ...?

Para cualquier periférico o dispositivo de tu ordenador que quieras configurar, lo normal será que antes cargues en memoria el controlador (driver) que lo va a manejar. En otros sistemas operativos, lo normal es que venga un ejecutable que se encargue de configurarlo todo.

En Linux, los controladores pueden venir así (como por ejemplo, es el caso de los controladores para modems de Conexant), en cuyo caso sólo hay que ejecutar un pequeño programita que se encarga de instalarlo todo, aunque por desgracia no es el caso más frecuente. Lo normal es que tengas que seguir los siguientes pasos:

a) Conectar el dispositivo
b) Fijarse en los mensajes de arranque del Kernel.
	Pueden pasar dos cosas:
	b.1)Que el kernel lo detecte por que el kernel que estemos usando tenga soporte para el dispositivo que queremos.
	    En este caso, solo nos quedaría configurar los programas que vayan a utilizar este dispositivo o periférico.

	b.2)Que el kernel no lo detecte. En este caso, tendremos que seguir uno de estos pasos:
	
		b.2.1: Si nuestra distribución de linux trae el controlador para nuestro dispositivo como un módulo ya
		       compilado, deberemos cargarlo.
		       [FIXME!!!] Mira la sección "Cargando Módulos". [/FIXME]
		b.2.2: "recompilar el kernel" con los controladores apropiados que se encarguen 
		de manejar el dispositivo que queremos instalar.
		
		c) Configurar el/los programas que vayan a utilizar el dispositivo.	


Recompilar el Kernel:

Aunque pueda parecer algo muy complejo, por lo raro que suena, configurar y recompilar el kernel no suele consistir (salvo dispositivos muy nuevos),más que en elegir algunas opciones en unos cuantos menús, escribir unos pocos comandos y esperar un rato, cuyo largo variará según la potencia de nuestra máquina.

En primer lugar, necesitamos asegurarnos de tener instaladas:
- El código fuente del kernel. (Suele venir en paquetes con nombres como kernel-source, o kernel-source-2.4.18, o similar).
  También puedes bajar la última versión del kernel en ftp.kernel.org, que probablemente será lo más adecuado si tu
  dispositivo es muy nuevo.
- Las utilidades de desarrollo GNU (make,gcc,etc).
- Si queremos configurarlo por medio de menús desde las X-window, necesitaremos tener instaladas las librerías tk
  (se instalan  por defecto en la gran mayoría de los casos).
- Si queremos configurarlo por medio de menús en modo texto, necesitaremos tener instalado el paquete libncurses5-dev (en tu distribución podría tener un nombre distinto, como curses-dev, ncurses-devel, o similar. Son todos lo mismo). [FIXME!!!] Para más información sobre como instalar paquetes, mira la sección de instalación. [/FIXME].

Una vez estamos seguros de tener todo esto instalado, hacemos lo siguiente:

	a)Abrimos un terminal o consola.
	b)Vamos al directorio donde se hayan instalado los fuentes del kernel. (Normalmente /usr/src/linux).

	  $cd /usr/src/linux
	
	  También es posible que los fuentes una vez instalados estén en formato comprimido .tar.gz, o .tar.bz2 en el 
	  directorio /usr/src. 
	  En ese caso,deberemos descomprimirlos con:
	  
	  $cd /usr/src
	  $bzcat kernel-source-X.XX.tar.bz2 | tar xv
	  
	  o sustituyendo "bzcat" por "zcat" si el fichero es un .tar.gz.

	  Por cuestiones de compatibilidad con otras cosas que podemos instalar después, conviene crear un enlace simbólico
	  llamado "linux" al directorio donde se encuentren los fuentes. Por ejemplo, si acabo de descomprimir los fuentes
	  a "kernel-source-2.4.20", estando dentro del directorio /usr/src, usaría el comando

	  $ln -s kernel-source-2.4.20 linux

	c)Ejecutamos la utilidad de configuración del kernel, estando ya dentro de /usr/src/linux.

	  $make menuconfig

	Nota: Para utilizar menús en modo X-window, en lugar de utilizar make menuconfig, utilizaríamos el comando

	  $make xconfig.
	  
 	      No obstante, debido a que podríamos no tener X-window cuando necesitemos configurar nuestro kernel, aquí
	      utilizaremos "make menuconfig".

	d)Debería aparecer un menú lleno de opciones, si no nos sale antes un mensaje de error diciéndonos que no tenemos
	  instaladas las libncurses-dev. (Ver más arriba para solucionar este problema).

	
	A pesar de que todas estas opciones puedan desconcertarnos en un principio, sólo necesitaremos configurar algunas
	para que nuesto sistema funcione correctamente. Debido a que ya hay libros enteros que hablan sobre cada una de 
	estas opciones, sólo mencionaré las de uso más común.

	
	En estos menús, veremos muchas opciones de las cuales cada una tiene 3 estados: Y<> M<> N<>. Como algunos podran
	suponer, Y<> y N<> significan "Sí" o "No". Esto significa que, cuando usemos este nuevo kernel que vamos a compilar,
	las opciones que hayamos marcado como "Y", estarán disponibles, y por tanto, si por ejemplo, hemos seleccionado
	"Y" en el driver para la tarjeta de sonido "Sound Blaster", cuando iniciemos linux con ese kernel, este detectará
	la tarjeta "Sound Blaster", y podremos utilizarla.

	La opción de compilar como módulo nos permite tener los controladores en un directorio
